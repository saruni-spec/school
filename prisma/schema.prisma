generator client {
  provider = "prisma-client-js"
}


datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


enum attendance_status {
  PRESENT
  ABSENT
  LATE
  EXCUSED
}
enum absence_reason {
  MEDICAL
  PERSONAL
  SCHOOL_RELATED

}

enum installment_types{
  SINGLE_PAYMENT
  WEEKLY
  MONTHLY
  SEMESTER
  ANNUAL
  EMERGENCY
}
enum employment_status {
  FULL_TIME
  PART_TIME
  CONTRACT
  INTERN
  TEMPORARY
  NONE
}


enum event_role {
  PARTICIPANT
  ORGANIZER
  JUDGE
  SUPERVISOR
}

enum timetable_status {
  DRAFT
  PUBLISHED
}

enum event_scope {
  INTER_SCHOOL
  INTRA_SCHOOL
  class_progression
  GRADE
  DEPARTMENT
  STREAM_LEVEL
  INDIVIDUAL
}

enum award_type {
  ACADEMIC_ACHIEVEMENT
  SPORTS
  INNOVATION
  HUMANITARIAN
  DILIGENCE
  COMMUNICATION
  PARTICIPATION
  CREATIVITY
}


enum exam_type {
  QUIZ
  MID_TERM
  FINAL
  ASSIGNMENT
}


enum facility_type {
  EDUCATIONAL
  RECREATIONAL
  DINING
  SPORTS
  TRANSPORTATION
  MEDICAL
  RESEARCH
}


enum fee_type_enum {
  TUITION
  LIBRARY
  SPORTS
  TRANSPORT
  FACILITY
  DEVELOPMENT
  COURSE_MATERIAL
  STATIONERY
  UNIFORM
  MEDICAL
  CULINARY
  LAB
  EVENT_PARTIPATION
  DAMAGE
  FINE
  MISCELLANEOUS
}


enum participant_type {
  STUDENT
  TEACHER
  STAFF
  GUEST
  GUARDIAN
}


enum participation_status {
  REGISTERED
  ATTENDED
  ABSENT
  WITHDRAWN
  DISQUALIFIED
}


enum payment_method {
  CASH
  BANK_TRANSFER
  CREDIT_CARD
  MOBILE_MONEY
  CHEQUE
}


enum payment_status {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
  OVERPAID
}


enum relationship_type {
  FATHER
  MOTHER
  GUARDIAN
  OTHER
}


enum reviewable_entity {
  SCHOOL
  SCHOOL_FACILITY
  EVENT
  TEACHER
}

enum grade_level_type {
  PRE_PRIMARY_1
  PRE_PRIMARY_2
  GRADE_1
  GRADE_2
  GRADE_3
  GRADE_4
  GRADE_5
  GRADE_6
  GRADE_7
  GRADE_8
  GRADE_9
  GRADE_10
  GRADE_11
  GRADE_12
}

enum school_type {
  PRE_PRIMARY
  LOWER_PRIMARY
  UPPER_PRIMARY
  LOWER_SECONDARY
  UPPER_SECONDARY
}



enum severity {
  EMERGENCY
  URGENT
  PRIOTITY
  INQUIRY
  LOW
}

enum week_days {
  MONDAY
  TUESDAY
  WEDNESDAY
  THURSDAY
  FRIDAY
  SATURDAY
  SUNDAY
}

// Enum for defining broad privilege categories
enum privilege_category {
  SYSTEM_ADMIN     // Absolute system control
  EXECUTIVE        // High-level management
  ADMINISTRATIVE   // Operational management
  OPERATIONAL      // Day-to-day operations
  SUPERVISORY      // Oversight and review
  PERSONAL         // Self-related access
}
// Enum for privilege scopes
enum privilege_scope {
  GLOBAL           // Entire system
  INSTITUTIONAL    // Entire institution
  DEPARTMENTAL     // Department level
  PERSONAL         // Individual level
}

enum system_resource {
 SYSTEM
  INSTITUTION
  USERS
  STUDENTS
  STAFF
  DEPARTMENTS
  EVENTS
  EXAMINATIONS
  FACILITIES
  FINANCES
  MEDICAL
  LIBRARY
  ACADEMIC_CLASSES
  ACADEMIC_STREAMS
  ADMISSIONS
  CURRICULUM
  COMMUNICATION
}

// Comprehensive Role Types Enum
enum role_type {
  // System-Level Roles
  SYSTEM_ADMINISTRATOR  // Absolute system control, highest level of access

  // Executive Leadership Roles
  PRINCIPAL             // Top institutional leadership
  VICE_PRINCIPAL        // Deputy institutional leadership
  SCHOOL_ADMINISTRATOR  // Comprehensive school-level administrative role

  // Academic Leadership Roles
  HEAD_OF_DEPARTMENT    // Department-level academic leadership
  ACADEMIC_REGISTRAR    // Academic records and registration management
  EXAM_CONTROLLER       // Examinations management
  CURRICULUM_COORDINATOR // Curriculum development and oversight

  // Teaching Roles
  TEACHER               // Standard teaching position
  CLASS_TEACHER         // Additional responsibilities for a specific class
  FACULTY_MEMBER        // Broader academic staff role

  // Administrative Roles
  ADMINISTRATIVE_STAFF  // General administrative support
  SECRETARY             // Administrative coordination
  FACILITY_MANAGER      // Facilities management
  FINANCIAL_OFFICER     // Financial management
  HUMAN_RESOURCES_MANAGER  // Personnel and HR management
  EVENT_COORDINATOR     // Event planning and management

  // Support and Specialized Roles
  LIBRARIAN             // Library management
  ASSISTANT_LIBRARIAN   // Support for library operations
  TECHNOLOGY_SUPPORT    // IT and technical support
  SECURITY_PERSONNEL    // Campus security
  LAB_TECHNICIAN
  INVENTORY_MANAGER
  
  // Student and Admission Related Roles
  ADMISSIONS_OFFICER    // Student admissions management
  COUNSELOR             // Student guidance and support
  
  // Medical and Health Roles
  MEDICAL_STAFF         // Healthcare professionals
  
  // Non-Academic Roles
  CHEF                  // Food services management

  // Student and Parent Roles
  STUDENT               // Current students
  PARENT                // Student guardians

  // Audit and Compliance
  AUDIT_OFFICER         // Compliance and internal audit
}

enum domain_specific_roles {
  MEMBER
  REPRESENTATIVE
  ASSISTANT_REPRESENTATIVE
  
}

enum picture_category {
  EVENT
  DOCUMENT
  CLASSROOM
  FINANCIAL
  STUDENT_WORK
  FACILITY
  EXTRACURRICULAR
  ADMINISTRATIVE
  ACHIEVEMENT
  MISCELLANEOUS
  EDUCATIONAL
  LOST_AND_FOUND
}

enum gallery_type {
  EVENT
  SCHOOL
  DEPARTMENT
  CLASS
  STUDENT
  STAFF
  ADMINISTRATIVE
  FACILITY
  FINANCE
  ACHIEVEMENTS
  MISCELLANEOUS
}

enum gallery_visibility {
  PRIVATE
  INTERNAL
  PUBLIC
}


//represents a school and details required for a school

model school {
  id                          Int                        @id @default(autoincrement())
  name                        String                     @db.VarChar(100)  @unique
  address                     String?
  contact_info                Json?
  license_info                Json?

  created_at                  DateTime?                  @default(now()) @db.Timestamptz(6)
  updated_at                  DateTime?                  @default(now()) @db.Timestamptz(6)
  deleted_at                  DateTime?                  @db.Timestamptz(6)

  academic_year               academic_year[]
  award                       award[]
  department                  department[]
  event_school_participant    event_school_participant[]
  fee                         fee[]
  review                      review[]
  school_facility             school_facility[]         
  permission                  permission[]
  users                       users[]
  course_material             course_material[]
  levels_offered              levels_offered[]
  stream                      stream[]
  event                       event[]
  announcement                announcement[]
  gallery                     gallery[]
  time_table                  time_table[]
}

// These are the different school levels,ie. LOWER_PRIMARY,UPPER_PRIMARY....that a spefic school has

model levels_offered{
  school_id                  Int
  school_level_id            Int
 
  school                     school?            @relation(fields: [school_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  school_level               school_level?      @relation(fields: [school_level_id], references: [id], onDelete: Restrict, onUpdate: Cascade)

  @@id([school_id,school_level_id])
}

// These are the different school types,ie. PRE_PRIMARY,LOWER_PRIMARY,UPPER_PRIMARY,LOWER_SECONDARY,UPPER_SECONDARY
// that can be offered by a school

model school_level {
  id                        Int                     @id   @default(autoincrement())
  type                      school_type             @unique

  levels_offered            levels_offered[]    
  grade_level               grade_level[]        
}

// Represents any facility that a school may have

model facility {
  id                      Int                     @id   @default(autoincrement())
  name                    String                  @db.VarChar(20)
  type                    facility_type         
  description             String?                 @db.VarChar(100)

  created_at              DateTime?               @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?               @default(now()) @db.Timestamptz(6)
  deleted_at              DateTime?               @db.Timestamptz(6)

  school_facility         school_facility[]       

  @@unique([name,type])

}

// Represents a school facility and the details of the facility

model school_facility {
  id                      Int                     @id @default(autoincrement())
  school_id               Int?
  facility_id             Int?
  capacity                Int?
  description             String?                 @db.VarChar(100)
  justification           String?                 @db.VarChar(100)

  created_at              DateTime?               @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?               @default(now()) @db.Timestamptz(6)
  deleted_at              DateTime?               @db.Timestamptz(6)

  
  opening_hours           DateTime?
  closing_hours           DateTime?

  facility                facility?               @relation(fields: [facility_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  school                  school?                 @relation(fields: [school_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  

  lib_books               lib_book[]
  permission              permission[]
  facility_staff          facility_staff[]

  @@unique([school_id,facility_id,capacity])
}

// Represents the start and end date of an academic year of a specific school

model academic_year {
  id                        Int               @id @default(autoincrement())
  school_id                 Int?
  year                      String            @db.VarChar(50)
  start_date                DateTime?         @db.Date
  end_date                  DateTime?         @db.Date
  is_current                Boolean?          @default(false)
  created_at                DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at                DateTime?         @db.Timestamptz(6)

  school                    school?           @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  
  semester                  semester[]
  class_progression         class_progression[]
  school_leader             school_leader[]
  
  @@unique([school_id, year])  
  @@unique([school_id,start_date])
  
}

// Represents a semester and the details of the semester of a specific academic year

model semester {
  id                     Int                    @id @default(autoincrement())
  academic_year_id       Int? 
  name                   String                 @db.VarChar(50) 
  start_date             DateTime               @db.Date
  end_date               DateTime               @db.Date
  is_current             Boolean?               @default(false)
  
  created_at             DateTime?              @default(now()) @db.Timestamptz(6)
  updated_at             DateTime?              @default(now()) @db.Timestamptz(6)
  deleted_at             DateTime?              @db.Timestamptz(6)

  academic_year          academic_year?         @relation(fields: [academic_year_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  student_ellectives     student_ellectives[]
  
  award                  award[]
  exam                   exam[]
  subject_allocation     subject_allocation[]
  time_table             time_table[]

  @@unique([academic_year_id,start_date])

}


model department {
  id                                         Int       @id @default(autoincrement())
  school_id                                  Int?
  name                                       String    @db.VarChar(100)
  description                                String?

  created_at                                 DateTime? @default(now()) @db.Timestamptz(6)
  updated_at                                 DateTime? @default(now()) @db.Timestamptz(6)
  deleted_at                                 DateTime? @db.Timestamptz(6)

  school                                     school?   @relation(fields: [school_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  
  staff                                      staff[]  
  subject_allocation                         subject_allocation[]
  permission                                 permission[]
  fee_payee                                  fee_payee[]
  award                                      award[]
  event_department_participant               event_department_participant[]

  @@unique([school_id,name])
  @@index([school_id])
}


// Represents the diffrent grades that are currently being offered in a school

model grade_level{
  id                         Int                        @id @default(autoincrement())
  level                      grade_level_type           @unique
  school_level_id            Int?

  created_at                 DateTime?                  @default(now()) @db.Timestamptz(6)
  updated_at                 DateTime?                  @default(now()) @db.Timestamptz(6)
  deleted_at                 DateTime?                  @db.Timestamptz(6)

  school_level               school_level?              @relation(fields: [school_level_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  
  stream                     stream[]
  subject_grade              subject_grade[]


}

// Represents a stream
// A stream is a division/part of a grade level

model stream {
  id                           Int                          @id @default(autoincrement())
  grade_level_id               Int?
  school_id                    Int?
  name                         String                       @db.VarChar(50)
  capacity                     Int?

  created_at                   DateTime?                    @default(now()) @db.Timestamptz(6)
  updated_at                   DateTime?                    @default(now()) @db.Timestamptz(6)
  deleted_at                   DateTime?                    @db.Timestamptz(6)

  grade_level                  grade_level?                 @relation(fields: [grade_level_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  school                       school?                      @relation(fields: [school_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  exam_sitting                 exam_sitting[]
  
  subject_allocation           subject_allocation[]
  
  slot_assignment              slot_assignment[]
  permission                   permission[]
  fee_payee                    fee_payee[]
  class_progression            class_progression[]

  @@unique([grade_level_id,name,school_id])
  @@index([school_id])
  
}

// Represents a colletion of students in the same class
// eg,class of 2024
// and their progression of a class through different grades
// eg.class of 2024 would be in a different grade each year


model class_progression {
  id                          Int                       @id @default(autoincrement())
  name                        String                    @db.VarChar(50)              
  is_current                  Boolean?  

  academic_year_id            Int?
  stream_id                   Int
  teacher_id                  Int?

  created_at                  DateTime?                  @default(now()) @db.Timestamptz(6)
  updated_at                  DateTime?                  @default(now()) @db.Timestamptz(6)
  deleted_at                  DateTime?                  @db.Timestamptz(6)


  academic_year               academic_year?             @relation(fields: [academic_year_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  stream                      stream?                    @relation(fields: [stream_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  teacher                     teacher?                   @relation(fields: [teacher_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  
  event_class_participant     event_class_participant[]
  permission                  permission[]
  student_class               student_class[]
  assignment                  assignment[]
  award                       award[]
  attendance                  attendance[]

  @@unique([stream_id,academic_year_id])
  @@unique([teacher_id,academic_year_id])
  @@map("class")
  @@index([academic_year_id])
  @@index([is_current])
}


//
//assining a student to a class group
//Will be used when a student changes schools,then they can be placed in a different class group

model student_class {
  id                         Int                 @id @default(autoincrement())
  student_id                 Int?
  class_progression_id       Int?
  

  student_role               domain_specific_roles?   @default(MEMBER)

  admission_date             DateTime?          @db.Date
  start_date                 DateTime?          @db.Date
  end_date                   DateTime?          @db.Date

  created_at                 DateTime?          @default(now()) @db.Timestamptz(6)
  updated_at                 DateTime?          @default(now()) @db.Timestamptz(6)
  deleted_at                 DateTime?          @db.Timestamptz(6)


  class_progression          class_progression?  @relation(fields: [class_progression_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  student                    student?            @relation(fields: [student_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@unique([student_id, class_progression_id])
  @@index([student_id])
}


model permission {
  id                   Int                 @id @default(autoincrement())
  role_id              Int
  resource             system_resource
  scope                privilege_scope     @default(DEPARTMENTAL)
 
  can_admin            Boolean             @default(false)
  can_create           Boolean             @default(false)
  can_read             Boolean             @default(false)
  can_update           Boolean             @default(false)
  can_delete           Boolean             @default(false)

  department_id        Int?
  school_id            Int?
  class_progression_id Int?
  school_facility_id   Int?
  stream_id            Int?

  created_at           DateTime            @default(now())
  updated_at           DateTime            @default(now())
  deleted_at           DateTime?

  department           department?         @relation(fields: [department_id], references: [id], onDelete: SetNull,onUpdate: Cascade)
  school               school?             @relation(fields: [school_id], references: [id], onDelete: SetNull,onUpdate: Cascade)
  class_progression    class_progression?  @relation(fields: [class_progression_id], references: [id], onDelete: SetNull,onUpdate: Cascade)          
  school_facility      school_facility?    @relation(fields: [school_facility_id], references: [id], onDelete: SetNull,onUpdate: Cascade)
  stream               stream?             @relation(fields: [stream_id], references: [id], onDelete: SetNull,onUpdate: Cascade)
  role                 role                @relation(fields: [role_id], references: [id], onDelete: Cascade,onUpdate: Cascade)
  
  @@unique([role_id, resource,scope,can_admin,can_create,can_delete,can_read,can_update])
  @@index([resource, department_id, school_id, class_progression_id,role_id])
}




model role {
  id                        Int                  @id @default(autoincrement())
  type                      role_type            @unique
  name                      String
  description               String?
  category                  privilege_category?
  
  created_at                DateTime             @default(now())
  updated_at                DateTime             @default(now())
  deleted_at                DateTime?
  

  permissions               permission[]
  users                     users[]
 
  @@unique([type, category])
}

model users {
  id                                 Int                      @id @default(autoincrement())
  name                               String?                  
  first_name                         String                   
  last_name                          String                  
  id_code                            String?                  @unique
  email                              String                   @unique 
  phone                              String?                
  date_of_birth                      DateTime?                @db.Date
  address                            String?
  password                           String
  emergency_contacts                 Json?
  role_id                            Int?
  
  created_at                         DateTime?                @default(now()) @db.Timestamptz(6)
  updated_at                         DateTime?                @default(now()) @db.Timestamptz(6)
  deleted_at                         DateTime?                @db.Timestamptz(6)


  school_id                          Int? 

  role                               role?                    @relation(fields: [role_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  school                             school?                  @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  announcement                       announcement[]
  event                              event[]
  event_user_participant             event_user_participant[]
  messages_messages_recepientTousers messages[]               @relation("messages_recepientTousers")
  messages_messages_senderTousers    messages[]               @relation("messages_senderTousers")
  review                             review[]
  parent                             parent[]
  staff                              staff[]
  student                            student[]
  admin                              admin[]
  picture                            picture[]
  medical                            medical[]
  course_material                    course_material[]
  fee_payee                          fee_payee[]
  award                              award[]
  payment                            payment[]
  attendance                         attendance[]
  gallery                            gallery[]

  @@index([school_id])
  @@index([role_id])
}


model school_leader {
  id                                 Int                @id @default(autoincrement())
  staff_id                           Int?               @unique

  academic_year_id                   Int?
  date_removed                       DateTime?          @db.Date
  reason_removed                     String?          

  created_at                         DateTime?          @default(now()) @db.Timestamptz(6)
  updated_at                         DateTime?          @default(now()) @db.Timestamptz(6)
  deleted_at                         DateTime?          @db.Timestamptz(6)

  staff                              staff?             @relation(fields: [staff_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  academic_year                      academic_year?     @relation(fields: [academic_year_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  fee                                fee[]
  attendance                         attendance[]

  @@index([academic_year_id])
 
}


model admin{
  id                                 Int                @id @default(autoincrement())
  users_id                           Int                @unique
  
  created_at                         DateTime?          @default(now()) @db.Timestamptz(6)
  updated_at                         DateTime?          @default(now()) @db.Timestamptz(6)
  deleted_at                         DateTime?          @db.Timestamptz(6)
 
  users                              users?             @relation(fields: [users_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
 

}


model staff {
  id                                              Int                 @id @default(autoincrement())
  users_id                                        Int                 @unique
  school_code                                     String?             
  department_id                                   Int?
  employment_status                               employment_status   @default(FULL_TIME) 

  domain_role                                     domain_specific_roles  @default(MEMBER)
  created_at                                      DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at                                      DateTime?           @default(now()) @db.Timestamptz(6)
  deleted_at                                      DateTime?           @db.Timestamptz(6)
  
  users                                           users?              @relation(fields: [users_id], references: [id], onDelete:Cascade, onUpdate:Cascade)
  department                                      department?         @relation(fields: [department_id], references: [id], onDelete:Cascade, onUpdate:Cascade)
  
  teacher                                         teacher[]
  facility                                        facility_staff[]
  school_leader                                   school_leader[]
  attendance                                      attendance[]

  @@index([users_id])
}


model teacher {
  id                    Int               @id @default(autoincrement())
  staff_id              Int?              @unique
  is_active             Boolean?          @default(true)

  created_at            DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at            DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at            DateTime?         @db.Timestamptz(6)


  staff                 staff?            @relation(fields: [staff_id], references: [id], onDelete: Restrict, onUpdate: Cascade)

  exam_sitting          exam_sitting[]
  result                result[]
  review                review[]
  subject_allocation    subject_allocation[]
  assignment            assignment[]
  class_progression     class_progression[]
  assignment_attempt    assignment_attempt[]

  @@index([staff_id])
}

model facility_staff {
  staff_id                  Int
  school_facility_id        Int

  role                      role_type?

  created_at                DateTime?               @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?               @default(now()) @db.Timestamptz(6)
  deleted_at                DateTime?               @db.Timestamptz(6)

  staff                     staff?                  @relation(fields: [staff_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  school_facility           school_facility?        @relation(fields: [school_facility_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@id([staff_id,school_facility_id])
}


model student {
  id                    Int               @id @default(autoincrement())
  admission_number      String?           
  student_code          String?            @unique
  users_id              Int?               @unique

  created_at            DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at            DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at            DateTime?         @db.Timestamptz(6)
          
  users                 users?            @relation(fields: [users_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  parent_student        parent_student[]
  result                result[]
  student_class         student_class[]
  student_ellectives    student_ellectives[]
  assignment_attempt    assignment_attempt[]

}

model parent_student {
  parent_id         Int
  student_id        Int

  created_at        DateTime? @default(now()) @db.Timestamptz(6)
  updated_at        DateTime? @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime? @db.Timestamptz(6)

  parent            parent    @relation(fields: [parent_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  student           student   @relation(fields: [student_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@id([parent_id, student_id])
}


model parent {
  id                Int               @id @default(autoincrement())
  users_id          Int?              @unique
  relationship_type relationship_type

  created_at        DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime?         @db.Timestamptz(6)

  users             users?            @relation(fields: [users_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  parent_student    parent_student[]

}


model subject {
  id                    Int               @id @default(autoincrement())
  name                  String            @db.VarChar(100) @unique
  description           String?

  created_at            DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at            DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at            DateTime?         @db.Timestamptz(6)


  
  subject_grade         subject_grade[]
  course_material       course_material[]
  lib_book              lib_book[]

}

model subject_grade { 
  id                    Int                     @id @default(autoincrement())
  subject_id            Int?
  grade_level_id        Int?
  name                  String?           
  description           String?
  created_at            DateTime?               @default(now())
  updated_at            DateTime?               @default(now())
  
  subject               subject?                @relation(fields: [subject_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  grade_level           grade_level?            @relation(fields: [grade_level_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  subject_allocation    subject_allocation[]

  @@unique([grade_level_id,subject_id])
}

model subject_allocation {
  id                        Int                       @id @default(autoincrement())
  department_id             Int?
  teacher_id                Int?
  subject_grade_id          Int?
  stream_id                 Int
  semester_id               Int?
  assigned_date             DateTime?                 @default(dbgenerated("CURRENT_DATE")) @db.Date

  created_at                DateTime?                 @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?                 @default(now()) @db.Timestamptz(6)
  deleted_at                DateTime?                 @db.Timestamptz(6)


  stream                    stream                    @relation(fields: [stream_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  semester                  semester?                 @relation(fields: [semester_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  subject_grade             subject_grade?            @relation(fields: [subject_grade_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  teacher                   teacher?                  @relation(fields: [teacher_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  department                department?               @relation(fields: [department_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  
  
  student_ellectives    student_ellectives[]
  exam_sitting          exam_sitting[]
  slot_assignment       slot_assignment[]
  assignment            assignment[]
  
  @@unique([teacher_id, subject_grade_id])
}


model slot_assignment {
  id                             Int                          @id @default(autoincrement())
  slot_id                        Int
  stream_id                      Int
  subject_allocation_id          Int
  created_at                     DateTime?                    @default(now()) @db.Timestamptz(6)
  updated_at                     DateTime?                    @default(now()) @db.Timestamptz(6)
  deleted_at                     DateTime?                    @db.Timestamptz(6)

  slot                           slot                         @relation(fields: [slot_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  subject_allocation             subject_allocation           @relation(fields: [subject_allocation_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  stream                         stream?                      @relation(fields: [stream_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  
  @@unique([slot_id, subject_allocation_id])
  @@index([subject_allocation_id])
}


model slot {
  id                Int           @id @default(autoincrement())
  name              String?       @db.VarChar(50)
  day_of_week       week_days
  start_time        String        @db.VarChar(30)
  end_time          String        @db.VarChar(30)
  room_number       String?       @db.VarChar(20)
  is_break          Boolean       @default(false)  
  time_table_id     Int?

  created_at        DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?     @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime?     @db.Timestamptz(6)

  time_table        time_table?   @relation(fields: [time_table_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
 
  slot_assignment   slot_assignment[]

  @@unique([day_of_week, start_time, time_table_id])
}


model time_table {
  id                Int              @id @default(autoincrement())
  name              String?          @db.VarChar(100)
  school_id         Int?
  semester_id       Int?
  status            timetable_status @default(DRAFT)
  is_active         Boolean          @default(false)
  
 
  slot_duration     Int           
  start_time        String?          @db.VarChar(30)
  end_time          String?          @db.VarChar(30)
  days_per_week     Int  
  breaks            Json?          //[{ startTime: string, duration: number }]
  
  created_at        DateTime?        @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?        @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime?        @db.Timestamptz(6)
  
  school            school?          @relation(fields: [school_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  semester          semester?        @relation(fields: [semester_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  
  
  slots             slot[]

  @@unique([school_id, semester_id, is_active])
}


model attendance {
  id                   Int                 @id @default(autoincrement())
  //
  // the person attending
  users_id             Int?
  //
  // the staff member checking the attendance
  staff_id             Int?
 
  class_progression_id Int?

  taken_on             DateTime?
  status               attendance_status?
  reason_for_absence   absence_reason?
  notified_on          DateTime?
  to_miss_on           DateTime?
  up_to                DateTime?
  //
  // the person who approved a absentee
  school_leader_id     Int?   

  created_at           DateTime            @default(now())
  updated_at           DateTime            @default(now())
  deleted_at           DateTime?

  users                users?              @relation(fields: [users_id], references: [id], onDelete: SetNull,onUpdate: Cascade)
  staff                staff?              @relation(fields: [staff_id], references: [id], onDelete: SetNull,onUpdate: Cascade)
  school_leader        school_leader?      @relation(fields: [school_leader_id], references: [id], onDelete: SetNull,onUpdate: Cascade)
  class_progression    class_progression?  @relation(fields: [class_progression_id], references: [id], onDelete: SetNull,onUpdate: Cascade)

  @@unique([users_id,created_at])
  @@index([users_id])
}


model medical {
  id                                Int                      @id @default(autoincrement())
  users_id                          Int
  description                       String                   @unique @db.VarChar(100)                              
  notes                             String                   @unique @db.VarChar(100)
  medic_id                          Int?

  created_at                        DateTime?                @default(now()) @db.Timestamptz(6)
  updated_at                        DateTime?                @default(now()) @db.Timestamptz(6)
  deleted_at                        DateTime?                @db.Timestamptz(6)

  users                             users?                   @relation(fields: [users_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@index([users_id])
}


model assignment {
  id                      Int                    @id @default(autoincrement())
  description             String                 @db.VarChar(100)
  teacher_id              Int
  subject_allocation_id   Int?
  class_progression_id    Int?
  due_date                DateTime?              @db.Date
  ref                     String?
  file_path               String?                @db.VarChar(250)

  created_at              DateTime?              @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?              @default(now()) @db.Timestamptz(6)
  deleted_at              DateTime?              @db.Timestamptz(6)


  teacher                 teacher?               @relation(fields: [teacher_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  subject_allocation      subject_allocation?    @relation(fields: [subject_allocation_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  class_progression       class_progression?     @relation(fields: [class_progression_id], references: [id], onDelete: SetNull, onUpdate: Cascade)


  assignment_content      assignment_content[]
  @@index([class_progression_id])
  @@index([subject_allocation_id])
}

model assignment_content{
  id                    Int                    @id @default(autoincrement())
  assignment_id         Int?               
  question              String?
  options               Json[]

  assignment            assignment?            @relation(fields: [assignment_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  assignment_attempt    assignment_attempt[]

  @@unique([assignment_id,question])

}

model assignment_attempt {
  id                          Int                      @id @default(autoincrement())
  assignment_content_id       Int?
  answer                      String?
  student_id                  Int?
  date_submitted              DateTime?
  date_marked                 DateTime?
  teacher_id                  Int?
  result                      Decimal?                  @db.Decimal(5, 2)
  assessment                  String?                   @db.VarChar(30)                  
  remarks                     String?                   @db.VarChar(50)
  

  created_at                  DateTime?                 @default(now()) @db.Timestamptz(6)
  updated_at                  DateTime?                 @default(now()) @db.Timestamptz(6)
  deleted_at                  DateTime?                 @db.Timestamptz(6)

  teacher                     teacher?                  @relation(fields: [teacher_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  student                     student?                  @relation(fields: [student_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  assignment_content          assignment_content?       @relation(fields: [assignment_content_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
 
 @@index([assignment_content_id])
 @@index([date_submitted])
}


model student_ellectives {
  student_id                  Int
  subject_allocation_id       Int
  semester_id                 Int
  enrollment_date             DateTime?                 @default(dbgenerated("CURRENT_DATE")) @db.Date

  created_at                  DateTime?                 @default(now()) @db.Timestamptz(6)
  updated_at                  DateTime?                 @default(now()) @db.Timestamptz(6)
  deleted_at                  DateTime?                 @db.Timestamptz(6)


  semester                    semester                  @relation(fields: [semester_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  subject_allocation          subject_allocation        @relation(fields: [subject_allocation_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  student                     student                   @relation(fields: [student_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  
  @@id([student_id, subject_allocation_id])
}





model exam {
  id                  Int            @id @default(autoincrement())
  semester_id         Int?
  name                String         @db.VarChar(30)
  exam_providers      String?        @db.VarChar(30)
  start_date          DateTime?      @db.Date
  end_date            DateTime?      @db.Date
  type                exam_type

  created_at          DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?      @default(now()) @db.Timestamptz(6)
  deleted_at          DateTime?      @db.Timestamptz(6)

  semester            semester?      @relation(fields: [semester_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  exam_sitting        exam_sitting[]

  @@unique([semester_id, name, type, start_date])
  @@index([start_date])
}


model exam_sitting {
  id                    Int                        @id @default(autoincrement())
  exam_id               Int?
  //
  //the supervisor of the sitting
  teacher_id            Int?
  subject_allocation_id Int?
  stream_id             Int?
  out_of                Decimal?                   @db.Decimal(5, 2)
  remarks               String?
  sitting_date          DateTime                   @db.Date

  created_at            DateTime?                  @default(now()) @db.Timestamptz(6)
  updated_at            DateTime?                  @default(now()) @db.Timestamptz(6)
  deleted_at            DateTime?                  @db.Timestamptz(6)

  total_marks           Int

  exam                  exam?                      @relation(fields: [exam_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  stream                stream?                    @relation(fields: [stream_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  subject_allocation    subject_allocation?        @relation(fields: [subject_allocation_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  teacher               teacher?                   @relation(fields: [teacher_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  result                result[]

  @@unique([stream_id, subject_allocation_id, exam_id, sitting_date])
  @@index([sitting_date])
}

model fee_payee {
  id                        Int               @id @default(autoincrement())
  fee_id                    Int?

  //
  //the possible payees of a fee,individual,all in a stream or all in a department or school
  users_id                  Int?
  stream_id                 Int?
  department_id             Int?

  whole_school              Boolean           @default(false)   

  created_at                DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at                DateTime?         @db.Timestamptz(6)


  users                     users?            @relation(fields: [users_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  stream                    stream?           @relation(fields: [stream_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  department                department?       @relation(fields: [department_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  fee                       fee?              @relation(fields: [fee_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  

  payment                   payment[]

  @@index([fee_id])
}


model fee {
  id                        Int               @id @default(autoincrement())
  code                      String            @db.VarChar(50)
  fee_for                   fee_type_enum
  description               String?           @db.VarChar(100)
  //
  //who approved the fee
  school_leader_id          Int?
  amount                    Decimal           @db.Decimal(10, 2)
  installments              installment_types
  due_date                  DateTime?         @db.Date
  school_id                 Int?  

  school_leader             school_leader?    @relation(fields: [school_leader_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  school                    school?           @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  created_at                DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at                DateTime?         @db.Timestamptz(6)

  fee_payee                  fee_payee[]

  @@unique([fee_for,amount,due_date])
  @@index([due_date])
}


model payment {
  id               Int             @id @default(autoincrement())
  users_id          Int?         
  fee_payee_id     Int?
  amount           Decimal         @db.Decimal(10, 2)
  balance          Decimal?        @db.Decimal(10, 2)
  payment_date     DateTime?       @default(now()) @db.Timestamptz(6)
  payment_method   payment_method
  status           payment_status? @default(PENDING)
  reference_number String          @unique @db.VarChar(100)

  created_at       DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?       @default(now()) @db.Timestamptz(6)
  deleted_at       DateTime?       @db.Timestamptz(6)

  fee_payee        fee_payee?      @relation(fields: [fee_payee_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  users            users?          @relation(fields: [users_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@index([users_id])
  @@index([payment_method])
  @@index([status])
}


model announcement {
  id              Int         @id @default(autoincrement())
  announcement    String?     @db.VarChar(500)

  date_for        DateTime    @db.Date
  valid_upto      DateTime    @db.Date
  scope           event_scope
  users_id        Int?
  school_id       Int?

  created_at      DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at      DateTime?   @default(now()) @db.Timestamptz(6)
  deleted_at      DateTime?   @db.Timestamptz(6)

  users           users?      @relation(fields: [users_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  school          school?     @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
 
 @@unique([school_id, date_for, users_id, scope,valid_upto])
}


model award {
  id                        Int               @id @default(autoincrement())
  name                      String?           @db.VarChar(20)
  description               String?         
  semester_id               Int?
  awarded_by                String?           @db.VarChar(20)
  type                      award_type
  awared_for                String?           @db.VarChar(100)
  users_id                  Int?
  class_progression_id      Int?
  department_id             Int?
  school_id                 Int?

  created_at                DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at                DateTime?         @db.Timestamptz(6)

  users                     users?            @relation(fields: [users_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  class_progression         class_progression? @relation(fields: [class_progression_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  department                department?       @relation(fields: [department_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  school                    school?           @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  semester                  semester?         @relation(fields: [semester_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

@@unique([semester_id,name])
}


model event {
  id                       Int                        @id @default(autoincrement())
  name                     String                     @db.VarChar(100)
  description              String?
  location                 String?                    @db.VarChar(200)
  start_date               DateTime                   @db.Timestamptz(6)
  end_date                 DateTime                   @db.Timestamptz(6)
  scope                    event_scope

  //
  // person who created the event
  users_id                 Int?
  school_id                Int?

  created_at               DateTime?                  @default(now()) @db.Timestamptz(6)
  updated_at               DateTime?                  @default(now()) @db.Timestamptz(6)
  deleted_at               DateTime?                  @db.Timestamptz(6)

  users                    users?                     @relation(fields: [users_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  school                   school?                    @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  event_class_participant  event_class_participant[]
  event_school_participant event_school_participant[]
  event_department_participant event_department_participant[]
  event_user_participant   event_user_participant[]
  review                   review[]

  @@index([start_date, end_date], map: "idx_event_date")
  @@index([scope], map: "idx_event_scope")
  @@unique([name,start_date,school_id])
}


model event_class_participant {
  event_id          Int
  class_progression_id          Int
  registration_date DateTime?             @default(now()) @db.Timestamptz(6)
  status            participation_status? @default(REGISTERED)

  created_at        DateTime?             @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?             @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime?             @db.Timestamptz(6)

  class_progression class_progression     @relation(fields: [class_progression_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  event             event                 @relation(fields: [event_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@id([event_id, class_progression_id])
}


model event_school_participant {
  event_id          Int
  school_id         Int
  registration_date DateTime?             @default(now()) @db.Timestamptz(6)
  status            participation_status? @default(REGISTERED)

  created_at        DateTime?             @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?             @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime?             @db.Timestamptz(6)

  event             event                 @relation(fields: [event_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  school            school                @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@id([event_id, school_id])
  @@index([event_id, school_id], map: "idx_event_school_participant")
}


model event_department_participant {
  event_id          Int
  department_id     Int
  registration_date DateTime?             @default(now()) @db.Timestamptz(6)
  status            participation_status? @default(REGISTERED)

  created_at        DateTime?             @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?             @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime?             @db.Timestamptz(6)

  event             event                 @relation(fields: [event_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  department        department            @relation(fields: [department_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@id([event_id, department_id])
}


model event_user_participant {
  event_id          Int
  users_id          Int
  participant_type  participant_type
  registration_date DateTime?             @default(now()) @db.Timestamptz(6)
  attendance_status participation_status? @default(REGISTERED)
  role              event_role?

  created_at        DateTime?             @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?             @default(now()) @db.Timestamptz(6)
  deleted_at        DateTime?             @db.Timestamptz(6)

  event             event                 @relation(fields: [event_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  users             users                 @relation(fields: [users_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@id([event_id, users_id])
  @@index([event_id, users_id], map: "idx_event_user_participant")
}


model messages {
  id                              Int         @id @default(autoincrement())
  message_details                 String?     @db.VarChar(200)
  topic                           String?     @db.VarChar(30)
  severity                        severity?
  sender                          Int?
  recepient                       Int?
  created_at                      DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at                      DateTime?   @default(now()) @db.Timestamptz(6)
  deleted_at                      DateTime?   @db.Timestamptz(6)


  users_messages_recepientTousers users?      @relation("messages_recepientTousers", fields: [recepient], references: [id], onDelete: SetNull, onUpdate: Cascade)
  users_messages_senderTousers    users?      @relation("messages_senderTousers", fields: [sender], references: [id], onDelete: SetNull, onUpdate: Cascade)

 @@index([sender])
@@index([recepient])

}

model result {
  student_id      Int
  //
  //the teacher who gave the result
  teacher_id      Int?

  marks_obtained  Decimal?        @db.Decimal(5, 2)
  exam_sitting_id Int

  created_at      DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at      DateTime?       @default(now()) @db.Timestamptz(6)
  deleted_at      DateTime?       @db.Timestamptz(6)

  exam_sitting    exam_sitting?   @relation(fields: [exam_sitting_id], references: [id], onDelete: Restrict, onUpdate: Cascade)
  teacher         teacher?        @relation(fields: [teacher_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  student         student         @relation(fields: [student_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

  @@id([student_id, exam_sitting_id])
  @@index([student_id])
}


model review {
  id                 Int               @id @default(autoincrement())
  users_id           Int?
  entity_type        reviewable_entity
  school_id          Int?
  school_facility_id Int?
  event_id           Int?
  teacher_id         Int?
  rating             Int
  title              String?           @db.VarChar(100)
  content            String

  created_at         DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at         DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at         DateTime?         @db.Timestamptz(6)

  event              event?            @relation(fields: [event_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  users              users?            @relation(fields: [users_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  school             school?           @relation(fields: [school_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  teacher            teacher?          @relation(fields: [teacher_id], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index([entity_type], map: "idx_review_entity_type")
  @@unique([users_id,entity_type,title])
}



// Represents course material and the details of the course material
// Course material can be published by a user
// Course material can be assigned to a school
// Course material can be assigned to a subject

model course_material {
  id                      Int                        @id @default(autoincrement())
  name                    String                     @db.VarChar(50)
  //
  //who published this
  users_id                Int?
  school_id               Int?
  subject_id              Int?
  grade_level             grade_level_type               
  description             String                     @db.VarChar(100)
  file_path               String                     @db.VarChar(50)
  topic                   String                     @db.VarChar(30)      

  subject                 subject?                   @relation(fields: [subject_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  school                  school?                    @relation(fields: [school_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  users                   users?                     @relation(fields: [users_id], references: [id], onDelete: SetNull, onUpdate: Cascade)

@@index([topic])
@@index([subject_id])
}


model gallery {
  id             Int             @id @default(autoincrement())
  name           String          @db.VarChar(255)
  description    String?         @db.Text
  type           gallery_type
  visibility     gallery_visibility @default(INTERNAL)
  category       picture_category

  school_id     Int?
  
  location       String?         @db.VarChar(255)
  //
  //the person who created this gallery
  users_id       Int?
  tags           String[]        @db.VarChar(50)
  
  created_at     DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @default(now()) @db.Timestamptz(6)
  deleted_at     DateTime?       @db.Timestamptz(6)

  school         school?         @relation(fields:[school_id],references :[id], onDelete: SetNull, onUpdate: Cascade)
  users          users?          @relation(fields:[users_id],references :[id], onDelete: SetNull, onUpdate: Cascade)

  picture        picture[]

  @@index([type])
  @@index([visibility])
  
}


model picture {
  id             Int             @id @default(autoincrement())
  gallery_id     Int?
  title          String?         @db.VarChar(255)
  
  file_path      String          @db.VarChar(500)
  file_name      String          @db.VarChar(255)
  file_size      Int             @db.Integer
  mime_type      String          @db.VarChar(100)
  
  taken_at       DateTime?       @db.Timestamptz(6)
  uploaded_at    DateTime        @default(now()) @db.Timestamptz(6)
  tags           String[]        @db.VarChar(50)
  
  users_id       Int?        
  
  created_at     DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @default(now()) @db.Timestamptz(6)
  deleted_at     DateTime?       @db.Timestamptz(6)

  gallery        gallery?        @relation(fields: [gallery_id], references: [id], onDelete: SetNull, onUpdate: Cascade)
  users          users?          @relation(fields:[users_id],references :[id], onDelete: SetNull, onUpdate: Cascade)

  @@index([gallery_id])
  @@index([taken_at])
  @@index([uploaded_at])
  
}
// Represents a library book and the details of the book

model lib_book {
  id                    Int              @id @default(autoincrement())
  school_facility_id    Int
  book_name             String
  reference_number      String
  parental_advisory     Boolean?
  subject_id            Int?
  borrowed_by           Int?
  borrowed_on           DateTime?
  due_by                DateTime?
  returned_on           DateTime?
  damaged_by            Int?
  created_at            DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at            DateTime?       @default(now()) @db.Timestamptz(6)
  deleted_at            DateTime?       @db.Timestamptz(6)

  school_facility       school_facility @relation(fields: [school_facility_id], references: [id], onDelete: Cascade, onUpdate: Cascade)
  

  subject               subject?        @relation(fields: [subject_id], references: [id])
}
